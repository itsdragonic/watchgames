<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Watch Engine</title>
    <style>
        body {
            margin: 0;
            height: 780px;
            background-color: #fff;
            font-family: Arial, sans-serif;
        }

        .rectangle {
            position: absolute;
            width: 20px;
            height: 60px;
            background: #000;
            border-radius: 20px;
        }

        #player {
            top: 450px;
            left: calc(85% - 20px);
        }

        #ai {
            top: 420px;
            left: calc(10% - 25px);
        }

        .circle {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: red;
            border-radius: 50%;
            top: 500px;
            left: 45%;
        }

        .middle-value {
            position: fixed;
            color: red;
            font-size: 16px;
            top: 20%;
            left: 10px;
            white-space: pre-line;
        }
    </style>
</head>
<body>
    <div id="player" class="rectangle"></div>
    <div id="ai" class="rectangle"></div>
    <div class="circle"></div>
    <div class="middle-value" id="middleValue"></div>

    <script>
        const circle = document.querySelector('.circle');
        const player = document.getElementById('player');
        const ai = document.getElementById('ai');
        const middleValueDisplay = document.getElementById('middleValue');

        let circleTop = 500;
        let playerTop = 450;
        let aiTop = 420;
        let lastScrollY = 0;
        let scrollTimeout, resetColorTimeout;

        function resetToCenter() {
            window.scrollTo({ top: document.body.scrollHeight / 2, behavior: 'instant' });
        }

        function bounceElement(element, topValue, direction) {
            // Adjust position dynamically and apply the bounce effect
            const offset = direction === 'up' ? -5 : 5;
            element.style.top = `${topValue + offset}px`;
            setTimeout(() => {
                element.style.top = `${topValue}px`;
            }, 200);
        }

        function handleScroll() {
            const currentScroll = window.scrollY;
            const middleY = document.body.scrollHeight / 2;

            if (currentScroll > middleY + 1) {
                // Scrolling up
                circle.style.backgroundColor = 'green';
                circleTop -= 15;
                playerTop -= 10;
                aiTop -= 8;

                bounceElement(circle, circleTop, 'up');
                bounceElement(player, playerTop, 'up');
                bounceElement(ai, aiTop, 'up');
            } else if (currentScroll < middleY - 1) {
                // Scrolling down
                circle.style.backgroundColor = 'blue';
                circleTop += 15;
                playerTop += 10;
                aiTop += 8;

                bounceElement(circle, circleTop, 'down');
                bounceElement(player, playerTop, 'down');
                bounceElement(ai, aiTop, 'down');
            }

            // Update positions
            circle.style.top = `${circleTop}px`;
            player.style.top = `${playerTop}px`;
            ai.style.top = `${aiTop}px`;

            // Reset scroll position
            resetToCenter();

            // Reset colors
            clearTimeout(resetColorTimeout);
            resetColorTimeout = setTimeout(() => {
                circle.style.backgroundColor = 'red';
            }, 500);

            // Clear scroll timeout
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                scrollSpeed = 0;
            }, 100);
        }

        function updateDebug() {
            middleValueDisplay.textContent = `Circle Top: ${circleTop}px\nPlayer Top: ${playerTop}px\nAI Top: ${aiTop}px`;
            requestAnimationFrame(updateDebug);
        }

        function continuousCentering() {
            resetToCenter();
            requestAnimationFrame(continuousCentering);
        }

        window.onscroll = handleScroll;

        window.onload = () => {
            resetToCenter();
            continuousCentering();
            updateDebug();
        };
    </script>
</body>
</html>
